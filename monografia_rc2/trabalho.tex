\chapter{Desenvolvimento do Trabalho}

\section{Considerações Iniciais}



\section{Atividades Realizadas}

\subsection{Biblioteca Cgraph}

 A biblioteca CGraph \cite{cesar2013cgraph} utilizada foi implementada por um dos autores (Cesar) 
durante seu trabalho de Iniciação Científica e Mestrado, utilizando a linguagem de programação C89 ANSI 
em ambiente POSIX. A biblioteca foi extendida por ambos os autores para análise de processos de disseminação.

A estrutura de dados \texttt{graph\_t} representa um grafo por meio de lista de adjacências, armazenando 
toda a informação necessária em memória física. Para um sistema com 4 GB de memória RAM e arquitetura de 
64 bits, um grafo direcionado está limitado a menos de 500 milhões de arestas, e um grafo não-direcionado 
está limitado a menos de 250 milhões de arestas.

A biblioteca ainda está incompleta, mas já possui diversos algoritmos para entrada, geração, métrica e 
simulação de grafos não-direcionados, apresentados a seguir:

\begin{itemize}
 \item Leitura de \textit{datasets}.
 \item Inserção de arestas, extração de subgrafo.
 \item Extração de componentes.
 \item Métricas de centralidade: grau, intermediação, proximidade, autovetor, PageRank e $k$-core.
 \item Cálculo de distância geodésica.
 \item Assortatividade.
 \item Modelos de rede: grafo completo, Erdös-Rényi, Barabási-Albert, Watts-Strogatz, Ravasz-Barabási.
 \item Layout com saída SVG: aleatório, circular, circular ordenado por grau, definido pelo usuário.
 \item Modelos de disseminação: SI, SIS, SIR, SEIR, Daley-Kendall, zumbi.
\end{itemize}

Os modelos de disseminação comportam apenas o caso de \emph{disseminação síncrona}, onde a cada
passo de tempo todos os individuos computam seu próximo estado, levando em conta seu estado atual e
uma possível interação com um indivíduo infeccioso. Não são suportados ainda a presença de mais que
um estado infeccioso, infecção de múltiplos indíviduos a cada passo de tempo (como no modelo em cascata
de Borge-Holthoefer et al \cite{borge2012locating}) ou modelos assíncronos, onde apenas um indivíduo infeccioso
transmite por turno.

A simulação é realizada de forma abstraída: a função \texttt{graph\_propagation\_t}
executa os passos, contando o número de indivíduos infecciosos e escolhendo uniformemente entre seus
adjacentes com quem ele interage. O modelo de propagação, representado na estrutura 
\texttt{graph\_propagation\_model\_t}, deve implementar dois \textit{callbacks} para a 
execução da propagação, de forma semelhante à especialização em orientação a objeto:

\begin{itemize}
 \item \texttt{graph\_transition\_t}: Determina a transição dos indivíduos, dependendo do estado atual e 
       das interações escolhidas.
 \item \texttt{graph\_is\_end\_t}: Determina se a propagação já atingiu um estado estacionário.
\end{itemize}

\subsection{Validação da simulação}

Como já discutido, modelos de disseminação podem ser compreendidos como um processo discreto ou 
contínuo. Em um processo discreto, cada indivíduo encontra-se em um dado estado, transitando em instantes
discretos conforme o estado dos seus vizinhos e de acordo com certas probabilidades. No processo contínuo, tais 
probabilidades são vistas como taxas de transição entre compartimentos, e o comportamento do processo é
obtido solucionando equações diferenciais. 

Espera-se que o resultado obtido em uma solução do modelo diferencial corresponda àquele observado em um 
grafo completo com um número infinito de vértices; na prática, bastam algumas centenas de vértices para
obter comportamentos semelhantes. 

O modelo discreto é solucionado sobre um grafo completo com $N=500$ vértices, com critério de parada de que 
nenhum vértice esteja no estado infeccioso. Tal critério não pode ser satisfeito para o modelo SIS sem um 
tempo de processamento muito longo, então a simulação é interrompida arbitrariamente após 90 iterações\footnotemark.

\footnotetext{Este limite corresponde a um limite codificado na biblioteca de propagação, onde o número de
iterações é limitado a $10 \log_2 N$, para evitar simulações onde a condição de parada é muito improvável ou
mesmo impossível.}

Para solucionar o modelo contínuo, empregamos um método de Runge-Kutta de ordem 2 com passo de tempo
$h=10^{-3}$. Definimos a proporção inicial de suscetíveis em $s_0 = 1-1/N$, e a de infectados em $i_0 = 1/N$. 
Definimos o critério de parada como satisfazer a inequação $|i - i_\infty| < 1/N$, onde $i$ é a proporção de 
indivíduos no estado infeccioso e $i_\infty$ é a solução analítica para $t \to \infty$. 

Utilizamos os parâmetros $\alpha=1$, $\beta=1/2$ e $\gamma=1$ para a solução numérica e para a
simulação em grafo, quando apropriado. Executamos 50 repetições da simulação, e calculamos a média e 
desvio padrão do número de passos e da proporção final de suscetíveis. Os resultados estão mostrados na 
Tabela \ref{tab:valida-simulacao}. Os dois modelos são em geral equivalentes, exceto por incompatibilidades
no tempo de propagação do modelo SIS e na proporção de suscetíveis do modelo Daley-Kendall. As causas 
destas discrepâncias não foram examinadas. 

\begin{table}[!hb]
 \centering
 \caption{Comparação entre solução diferencial e simulação em grafo completo}\label{tab:valida-simulacao}
 \begin{tabular}{|l|c|cc|cc|}
  \hline
  \multirow{2}{*}{Modelo} & \multirow{2}{*}{$s_\infty$ (\%)} & \multicolumn{2}{c|}{Diferencial} & \multicolumn{2}{c|}{Simulação} \\ \cline{3-6}
                          &                                    & Tempo & Suscetíveis (\%)         & Tempo        & Suscetíveis (\%) \\ \hline
  SI                      &  0.0000                            & 12.4  & 0.20                     & 17.2$\pm$1.3 & 0.00             \\
  SIS                     &  50.000                            & 22.1  & 50.2                     &              & 49.9$\pm$2.3     \\
  SIR                     &  20.389                            & 32.5  & 20.4                     & 32.3$\pm$3.4 & 20.5$\pm$2.7     \\
  SEIR                    &  20.389                            & 44.2  & 20.4                     & 47.0$\pm$5.6 & 20.2$\pm$2.9     \\
  Daley-Kendall           &  5.8924                            & 22.5  & 5.98                     & 24.6$\pm$2.8 & 8.4$\pm$1.5      \\ \hline
 \end{tabular}
\end{table}

\subsection{Propagação em \textit{datasets}}

 

\begin{table}[!ht]
 \centering
 \caption{Execução em datasets}\label{tab:dataset-simulation}
 \begin{tabular}{|l|ccccc|cc|}
  \hline
  \textit{dataset} & $N$   & $\langle k \rangle$ & $\langle C \rangle$ & $r$    & $\kappa$ & Tempo            & Suscetíveis (\%) \\ \hline
             mac95 & 94    & 32.2                & 0.774               & -0.391 & 28       & $21.30 \pm 6.5$  & $38.72 \pm 16.6$ \\
               cat & 95    & 24.6                & 0.615               & -0.140 & 19       & $21.46 \pm 7.0$  & $41.77 \pm 18.6$ \\
           mangdry & 97    & 29.8                & 0.461               & -0.532 & 23       & $21.98 \pm 4.2$  & $33.03 \pm 11.5$ \\
           mangwet & 97    & 29.8                & 0.468               & -0.539 & 23       & $21.74 \pm 5.1$  & $35.81 \pm 14.3$ \\
            baydry & 128   & 32.9                & 0.335               & -0.133 & 24       & $23.76 \pm 6.8$  & $37.08 \pm 17.1$ \\
            baywet & 128   & 32.4                & 0.335               & -0.157 & 23       & $23.98 \pm 5.5$  & $32.20 \pm 11.6$ \\
             email & 1133  & 9.62                & 0.221               & +0.112 & 11       & $41.90 \pm 14.5$ & $64.16 \pm 12.3$ \\
         powergrid & 4941  & 2.67                & 0.080               & -0.073 & 5        & $12.54 \pm 8.5$  & $99.71 \pm 0.3$  \\
          internet & 22963 & 4.22                & 0.230               & -0.041 & 25       & $37.26 \pm 20.1$ & $99.13 \pm 0.6$  \\
      astrophysics & 16706 & 16.1                & 0.670               & +0.452 & 56       & $62.22 \pm 26.5$ & $75.99 \pm 10.6$ \\
               15m & 87569 & 109.9               & 0.224               & -0.164 & 185      & $72.26 \pm 5.4$  & $80.19 \pm 0.3$  \\ \hline
 \end{tabular}
\end{table}


\subsection{Comparação entre modelos de propagação com $R_0$ equivalente}



\subsection{Aplicação de propagação de informação em problemas reais}



\subsubsection{Gripe suína em Hong Kong}



\subsubsection{Sobrevivência ao Apocalipse Zombie}



\section{Resultados Obtidos}


