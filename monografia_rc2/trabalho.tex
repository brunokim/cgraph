\chapter{Desenvolvimento do Trabalho}

\section{Considerações Iniciais}



\section{Atividades Realizadas}

\subsection{Biblioteca Cgraph}

 A biblioteca CGraph \cite{cesar2013cgraph} utilizada foi implementada por um dos autores (Cesar) 
durante seu trabalho de Iniciação Científica e Mestrado, utilizando a linguagem de programação C89 ANSI 
em ambiente POSIX. A biblioteca foi extendida por ambos os autores para análise de processos de disseminação.

A estrutura de dados \texttt{graph\_t} representa um grafo por meio de lista de adjacências, armazenando 
toda a informação necessária em memória física. Para um sistema com 4 GB de memória RAM e arquitetura de 
64 bits, um grafo direcionado está limitado a menos de 500 milhões de arestas, e um grafo não-direcionado 
está limitado a menos de 250 milhões de arestas.

A biblioteca ainda está incompleta, mas já possui diversos algoritmos para entrada, geração, métrica e 
simulação de grafos não-direcionados, apresentados a seguir:

\begin{itemize}
 \item Leitura de \textit{datasets}.
 \item Inserção de arestas, extração de subgrafo.
 \item Extração de componentes.
 \item Métricas de centralidade: grau, intermediação, proximidade, autovetor, PageRank e $k$-core.
 \item Cálculo de distância geodésica.
 \item Assortatividade.
 \item Modelos de rede: grafo completo, Erdös-Rényi, Barabási-Albert, Watts-Strogatz, Ravasz-Barabási.
 \item Layout com saída SVG: aleatório, circular, circular ordenado por grau, definido pelo usuário.
 \item Modelos de disseminação: SI, SIS, SIR, SEIR, Daley-Kendall, zumbi.
\end{itemize}

Os modelos de disseminação comportam apenas o caso de \emph{disseminação síncrona}, onde a cada
passo de tempo todos os individuos computam seu próximo estado, levando em conta seu estado atual e
uma possível interação com um indivíduo infeccioso. Não são suportados ainda a presença de mais que
um estado infeccioso, infecção de múltiplos indíviduos a cada passo de tempo (como no modelo em cascata
de Borge et al \cite{borge2011structural}) ou modelos assíncronos, onde apenas um indivíduo infeccioso
transmite por turno.

A simulação é realizada de forma abstraída: a função \texttt{graph\_propagation\_t}
executa os passos, contando o número de indivíduos infecciosos e escolhendo uniformemente entre seus
adjacentes com quem ele interage. O modelo de propagação, representado na estrutura 
\texttt{graph\_propagation\_model\_t}, deve implementar dois \textit{callbacks} para a 
execução da propagação, de forma semelhante à especialização em orientação a objeto:

\begin{itemize}
 \item \texttt{graph\_transition\_t}: Determina a transição dos indivíduos, dependendo do estado atual e 
       das interações escolhidas.
 \item \texttt{graph\_is\_end\_t}: Determina se a propagação já atingiu um estado estacionário.
\end{itemize}

\subsection{Validação da simulação}

Como já discutido, modelos de disseminação podem ser compreendidos como um processo discreto ou 
contínuo. Em um processo discreto, cada indivíduo encontra-se em um dado estado, transitando em instantes
discretos conforme o estado dos seus vizinhos e de acordo com certas probabilidades. No processo contínuo, tais 
probabilidades são vistas como taxas de transição entre compartimentos, e o comportamento do processo é
obtido solucionando equações diferenciais. 

Espera-se que o resultado obtido em uma solução do modelo diferencial corresponda àquele observado em um 
grafo completo com um número infinito de vértices; na prática, bastam algumas centenas de vértices para
obter comportamentos semelhantes. 

O modelo discreto é solucionado sobre um grafo completo com $N=500$ vértices, com critério de parada de que 
nenhum vértice esteja no estado infeccioso. Tal critério não pode ser satisfeito para o modelo SIS sem um 
tempo de processamento muito longo, então a simulação é interrompida arbitrariamente após 90 iterações\footnotemark.

\footnotetext{Este limite corresponde a um limite codificado na biblioteca de propagação, onde o número de
iterações é limitado a $10 \log_2 N$, para evitar simulações onde a condição de parada é muito improvável ou
mesmo impossível.}

Para solucionar o modelo contínuo, empregamos um método de Runge-Kutta de ordem 2 com passo de tempo
$h=10^{-3}$. Definimos a proporção inicial de suscetíveis em $s_0 = 1-1/N$, e a de infectados em $i_0 = 1/N$. 
Definimos o critério de parada como satisfazer a inequação $|i - i_\infty| < 1/N$, onde $i$ é a proporção de 
indivíduos no estado infeccioso e $i_\infty$ é a solução analítica para $t \to \infty$. 

Utilizamos os parâmetros $\alpha=1$, $\beta=1/2$ e $\gamma=1$ para a solução numérica e para a
simulação em grafo, quando apropriado. Executamos 50 repetições da simulação, e calculamos a média e 
desvio padrão do número de passos e da proporção final de suscetíveis. Os resultados estão mostrados na 
Tabela \ref{tab:valida-simulacao}. Os dois modelos são em geral equivalentes, exceto por incompatibilidades
no tempo de propagação do modelo SIS e na proporção de suscetíveis do modelo Daley-Kendall. As causas 
destas discrepâncias não foram examinadas. 

\begin{table}[!hb]
 \centering
 \caption{Comparação entre solução diferencial e simulação em grafo completo}\label{tab:valida-simulacao}
 \begin{tabular}{|l|c|cc|cc|}
  \hline
  \multirow{2}{*}{Modelo} & \multirow{2}{*}{$s_\infty$ (\%)} & \multicolumn{2}{c|}{Diferencial} & \multicolumn{2}{c|}{Simulação} \\ \cline{3-6}
                          &                                    & Tempo & Suscetíveis (\%)         & Tempo        & Suscetíveis (\%) \\ \hline
  SI                      &  0.0000                            & 12.4  & 0.20                     & 17.2$\pm$1.3 & 0.00             \\
  SIS                     &  50.000                            & 22.1  & 50.2                     &   -          & 49.9$\pm$2.3     \\
  SIR                     &  20.389                            & 32.5  & 20.4                     & 32.3$\pm$3.4 & 20.5$\pm$2.7     \\
  SEIR                    &  20.389                            & 44.2  & 20.4                     & 47.0$\pm$5.6 & 20.2$\pm$2.9     \\
  Daley-Kendall           &  5.8924                            & 22.5  & 5.98                     & 24.6$\pm$2.8 & 8.4$\pm$1.5      \\ \hline
 \end{tabular}
\end{table}

\subsection{Propagação em datasets e em modelos equivalentes}



\subsection{Comparação em solução numérica e solução em redes complexas}



\subsection{Comparação entre modelos de propagação com $R_0$ equivalente}



\subsection{Aplicação de propagação de informação em poblemas reais}



\subsubsection{Gripe suína em Hong Kong}



\subsubsection{Sobrevivência ao Apocalipse Zombie}



\section{Resultados Obtidos}


